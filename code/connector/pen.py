import nmap
import json

def Run(login):
    nm = nmap.PortScanner()
    target = login.hostName
    nm.scan(target, '22-443')
    status = nm.scanstats()
    returnValue = ""
    if status['uphosts'] == '1':
        hosts = nm.all_hosts()
        print(json.dumps(nm[hosts[0]], indent=4))
        returnValue = json.dumps(nm[hosts[0]], indent=4)
    else:
        print("Error")
        returnValue = "Error"
    login.print()

    print("Done PEN")
    return returnValue
